# Подзадание 1.1 Анализ и планирование 
Существующее монолитное приложение написано на Java, использует базу данных Postgres и реализует две основные функции (они же домены): 
1. мониторинг температуры
2. управление отоплением

Взаимодействие приложения с датчиками происходит синхронно.
Низкая способность к масштабированию т.к. монолитное приложение невозможно масштабировать по частям

На основе выделенных доменом можно определить следующие контексты:
- в контекст мониторинга температуры входит: сервис запроса, обработки и хранения полученного значения температуры, информация полученная с датчиков температуры, команды посылаемые сервису управления температурой на включение или отключение отопления, когда значение выходит за рамки ожидаемого
- в контекст управления отоплением входит: сервис управления переключением температуры, хранение данных о переключении реле, состояние переключателя, команды управления включением/отключением отопления от сервиса мониторинга или от пользователя через веб-интерфейс.


# Подзадание 1.2: Архитектура микросервисов

Целевая микросервисная архитектура выглядит следующим образом:
Api Gateway

Микросервисы: 
- сервис управления домами - создание домов, регистрация устройств
- сервис управления устройствами - отправка команд на устройства
- сервис отопления - чтение из кафки и хранение телеметрических данных с датчиков температуры, задание целевой температуры и ее поддержание
- сервис освещения - чтение из кафки и хранение телеметрических данных с устройств управления освещением
- сервис управления воротами - чтение из кафки и хранение телеметрических данных с устройств управления воротами
- сервис видеонаблюдения - чтение из кафки и хранение телеметрических данных с устройств управления камерами, хранение видео

кафка - принимает данные с устройств управления системы умный дом и предоставляет соответствующим сервисам

В директории ex1_2 находятся С4 диаграммы контейнеров, компонентов и кода
# Подзадание 1.3: Entity Relations диаграмма находится в папке ex1_3

# Подзадание 1.4: Gроектирование API

API сервиса управления домами и сервиса отопления
сервис управления домами:

GET /houses - список домов

GET /houses/{id} - получить дом по id

GET /houses/{id}/devices - получить список устройств в доме

POST /houses/add - создать новый дом

POST /houses/{id}/devices/add - добавить новое устройство

DELETE /houses/{id}/devices/{devise_id} - удалить устройство

PUT /houses/{id} - редактировать дом 

PUT /houses/{id}/devices/{devise_id} - редактировать устройство

cервис управления  отоплением:

GET /heater/house/{id}/targetTemperature - получить целевую температуру для данного дома

PUT /heater/house/{id}/targetTemperature - задать целевую температуру для данного дома

GET /heater/house/{id}/historyTemperature - получить список значений температуры за определенный период

GET /heater/device/{id}/status - получить статус устройства по айди

PUT /heater/devise/{id}/status - обновить состояние устройства (вкл/выкл)

Модели данных:

house:
```
{
    "id_house" : String,
    "address" : String,
    "id_user" : String,
    "devices" : []
}
```

device:
```
{
    "id_device" : String,
    "type" : String,
    "maker" : String,
    "status" : String,
    "serial_number" : String
}
```

swagger документация в файле /docs/ex1_4/api.yaml